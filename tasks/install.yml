---
- name: Install Packages | apt
  apt:
    state: latest
    pkg: "{{ item }}"
  with_items:
    - elasticsearch
  tags:
    - software-installation
    - using-apt
    - elasticsearch

- name: Remove plugin cloud-aws
  command: /usr/share/elasticsearch/bin/plugin remove cloud-aws
  when: elasticsearch_cloud_aws_enabled

- name: Remove plugin lmenezes/elasticsearch-kopf
  command: /usr/share/elasticsearch/bin/plugin remove lmenezes/elasticsearch-kopf
  when: elasticsearch_kopf_enabled

- name: Install elasticsearch-cloud-aws 2.7.1 plugin
  command: /usr/share/elasticsearch/bin/plugin install elasticsearch/elasticsearch-cloud-aws/2.7.1 creates=/usr/share/elasticsearch/plugins/cloud-aws
  when: elasticsearch_cloud_aws_enabled
  tags:
    - elasticsearch

- name: Install lmenezes/elasticsearch-kopf
  command: /usr/share/elasticsearch/bin/plugin install lmenezes/elasticsearch-kopf
  when: elasticsearch_kopf_enabled
  tags:
    - elasticsearch
